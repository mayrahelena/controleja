<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Registros de Ponto - Administração</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='registros.css') }}" />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat&family=Merriweather&display=swap" rel="stylesheet">

    <link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@700&family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>
	<main id="registros-page">
		<section class="registros-container">
			<div class="page-header">
                <a href="{{ url_for('admin') }}" class="btn-voltar">← Voltar</a>
			</div>
			<h1 class="registros-title">Registros de Ponto</h1>

			{% with messages = get_flashed_messages() %}
			{% if messages %}
				<div class="registros-flash-messages">
					{% for msg in messages %}
						<p>{{ msg }}</p>
					{% endfor %}
				</div>
			{% endif %}
			{% endwith %}

			<!-- Filtro de período -->
			<form id="registros-filter-form" class="registros-filter-form" method="post" action="{{ url_for('listar_registros') }}">
				<label for="data_inicio" class="registros-label">Data Início:</label>
				<input type="date" id="data_inicio" name="data_inicio" max="{{ date_fim }}" required value="{{ data_inicio }}" class="registros-input-date">

				<label for="data_fim" class="registros-label">Data Fim:</label>
				<input type="date" id="data_fim" name="data_fim" max="{{ date_fim }}" required value="{{ data_fim }}" class="registros-input-date">

				<button type="submit" class="btn-primary registros-btn-filter">Filtrar</button>
			</form>


			<p class="registros-actions">
				<a href="{{ url_for('novo_registro') }}" class="registros-link">Incluir Registro Manual</a>
			</p>

			{% if registros_por_func %}
				{% for func_nome, registros in registros_por_func.items() %}
					<section class="funcionaria-section">
						<h3 class="funcionaria-name">{{ func_nome }}</h3>

                        <!-- Cabeçalho para ≥1200px (desktop) -->
						<div class="registros-header" aria-hidden="true">
							<span>Data</span>
							<span>Entrada</span>
							<span>Saída</span>
							<span>Observações</span>
							<span>Ações</span>
						</div>

						<section class="funcionaria-cards">
							{% for r in registros %}
								<article class="registro-card">
									<p class="registro-field">
										<strong>Data:</strong><br>
										<span>{{ r.data }}</span>
									</p>
									<p class="registro-field">
										<strong>Entrada:</strong><br>
										<span>{{ r.hora_entrada }}</span>
									</p>
									<p class="registro-field">
										<strong>Saída:</strong><br>
										<span>{{ r.hora_saida }}</span>
									</p>
									<p class="registro-field observacoes">
										<strong>Observações:</strong><br>
										<span>{{ r.observacoes }}</span>
									</p>

									<div class="card-actions">
										<a href="{{ url_for('editar_registro', record_id=r.id) }}" class="registros-edit-link">Editar</a>

										<form method="post" action="{{ url_for('excluir_registro', record_id=r.id) }}" class="registros-delete-form" onsubmit="return confirm('Confirma exclusão?');" style="display:inline;">
											<button type="submit" class="btn-link registros-delete-button">Excluir</button>
										</form>
									</div>
								</article>
							{% endfor %}
						</section>
					</section>
				{% endfor %}
			{% else %}
				<p class="registros-no-data">Nenhum registro encontrado.</p>
			{% endif %}

			<p class="registros-back">
				<a href="{{ url_for('admin') }}" class="btn-voltar">← Voltar</a>
			</p>
		</section>
	</main>
</body>
</html>